{
    "componentChunkName": "component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx",
    "path": "/미니큐브에-efk-설치하기",
    "result": {"data":{"post":{"slug":"/미니큐브에-efk-설치하기","title":"미니큐브에 EFK 설치하기","date":"06.11.2021","tags":null,"description":"미니큐브에 Elasticsearch, Fluent bit, Kibana 설치하기","canonicalUrl":null,"body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"미니큐브에 EFK 설치하기\",\n  \"date\": \"2021-11-06T00:00:00.000Z\",\n  \"description\": \"미니큐브에 Elasticsearch, Fluent bit, Kibana 설치하기\"\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"\\uCD5C\\uADFC\\uC5D0 \\uB9E5\\uBD81\\uC5D0 \\uC124\\uCE58\\uB418\\uC5B4\\uC788\\uB358 Docker Desktop \\uC744 \\uAC77\\uC5B4\\uB0B4\\uBA74\\uC11C Minikube \\uB97C \\uC124\\uCE58\\uD588\\uB2E4.\\n\\uAE30\\uC655 \\uB85C\\uCEEC\\uC5D0 \\uD074\\uB7EC\\uC2A4\\uD130\\uB97C \\uAD6C\\uCD95\\uD55C \\uAE30\\uB150\\uC73C\\uB85C \\uBB58 \\uD574\\uBCFC\\uAE4C \\uC0DD\\uAC01\\uD558\\uB358 \\uC911 \\uD604\\uC7AC \\uD68C\\uC0AC\\uC5D0\\uC11C \\uC0AC\\uC6A9\\uD558\\uB294 EFK \\uB97C \\uC124\\uCE58\\uD574\\uBCF4\\uB824\\uACE0 \\uD55C\\uB2E4.\"), mdx(\"p\", null, \"\\uC6B0\\uC120 elasticsearch \\uB97C \\uBA3C\\uC800 \\uBC30\\uD3EC\\uD569\\uB2C8\\uB2E4.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-yaml:title=elasticsearch.yaml\",\n    \"metastring\": \"{16-22,37-41}\",\n    \"{16-22,37-41}\": true\n  }, \"apiVersion: apps/v1\\nkind: StatefulSet\\nmetadata:\\n  name: elasticsearch\\nspec:\\n  serviceName: \\\"elasticsearch\\\"\\n  replicas: 1\\n  selector:\\n    matchLabels:\\n      app: elasticsearch\\n  template:\\n    metadata:\\n      labels:\\n        app: elasticsearch\\n    spec:\\n      initContainers:\\n      - name: chmod\\n        image: amsy810/tools:v2.0\\n        command: ['chown', '-R', '1000:1000', '/usr/share/elasticsearch/data']\\n        volumeMounts:\\n          - name: data\\n            mountPath: /usr/share/elasticsearch/data\\n      containers:\\n      - name: elasticsearch\\n        image: docker.elastic.co/elasticsearch/elasticsearch:6.6.1\\n        env:\\n        - name: discovery.type\\n          value: single-node\\n        ports:\\n        - containerPort: 9200\\n          name: client\\n        - containerPort: 9300\\n          name: nodes\\n        volumeMounts:\\n        - name: data\\n          mountPath: /usr/share/elasticsearch/data\\n      volumes:\\n      - name: data\\n        hostPath:\\n          path: /mnt/elasticsearch\\n          type: DirectoryOrCreate\\n---\\napiVersion: v1\\nkind: Service\\nmetadata:\\n  name: elasticsearch\\n  labels:\\n    service: elasticsearch\\nspec:\\n  ports:\\n  - port: 9200\\n    name: client\\n  - port: 9300\\n    name: nodes\\n  selector:\\n    app: elasticsearch\\n\")), mdx(\"p\", null, \"StatefulSet\\uB294 Mysql \\uAC19\\uC740 \\uB370\\uC774\\uD130\\uB97C \\uAC00\\uC9C4 Pod \\uC744 \\uAD00\\uB9AC\\uD560 \\uB54C \\uC0AC\\uC6A9\\uD558\\uB294\\uB370 Elasticsearch\\uB3C4 \\uB9C8\\uCC2C\\uAC00\\uC9C0\\uB85C \\uB370\\uC774\\uD130\\uB97C \\uC800\\uC7A5\\uD560 \\uACF5\\uAC04(Volume)\\uC744\\n\\uC5F0\\uACB0 \\uD574\\uC57C\\uD55C\\uB2E4 \\uADF8\\uB798\\uC11C Volume Mount \\uC885\\uB958\\uC778 hostPath\\uB85C \\uC5F0\\uACB0\\uC744 \\uD574\\uC900\\uB2E4.\"), mdx(\"p\", null, \"\\uADF8\\uB9AC\\uACE0 initContainers \\uC635\\uC158\\uC744 \\uC8FC\\uC9C0 \\uC54A\\uACE0 Pod\\uC744 \\uAC00\\uB3D9\\uC2DC\\uD0A4\\uBA74 \\uC77D\\uC744 \\uC218 \\uC5C6\\uB2E4\\uACE0 \\uC5D0\\uB7EC\\uAC00 \\uB72C\\uB2E4. initContainers\\uC5D0\\uC11C \\uC5F0\\uACB0\\uB418\\uB294 Volume\\uC758 \\uAD8C\\uD55C\\uC744 \\uBC14\\uAFD4\\uC900\\uB2E4.\"), mdx(\"p\", null, \"\\uB2E4\\uC74C\\uC73C\\uB85C kibana\\uB97C \\uC124\\uCE58\\uD574\\uBCFC \\uCC28\\uB840\\uC778\\uB370 kibana yaml \\uC124\\uC815\\uC740 \\uADF8\\uB807\\uAC8C \\uC5B4\\uB835\\uC9C0 \\uC54A\\uB2E4.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-yaml:title=kibana.yaml\"\n  }, \"apiVersion: apps/v1\\nkind: Deployment\\nmetadata:\\n  name: kibana-deployment\\n  labels:\\n    app: kibana\\nspec:\\n  replicas: 1\\n  selector:\\n    matchLabels:\\n      app: kibana\\n  template:\\n    metadata:\\n      labels:\\n        app: kibana\\n    spec:\\n      containers:\\n      - name: kibana\\n        image: docker.elastic.co/kibana/kibana:6.6.1\\n        ports:\\n        - containerPort: 5601\\n          name: webinterface\\n---\\napiVersion: v1\\nkind: Service\\nmetadata:\\n  name: kibana\\n  labels:\\n    service: kibana\\nspec:\\n  type: NodePort\\n  ports:\\n  - port: 5601\\n    name: webinterface\\n  selector:\\n    app: kibana\\n\")), mdx(\"p\", null, \"\\uB2E4\\uC74C\\uC740 fluent bit \\uC124\\uC815\\uC778\\uB370 ServiceAccount, ClusterRole, ClusterRoleBinding, ConfigMap, Deployment And Service\\uB97C \\uCC28\\uB840\\uB300\\uB85C\\n\\uBC30\\uD3EC\\uD574\\uC8FC\\uBA74 \\uB41C\\uB2E4.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-yaml\",\n    \"metastring\": \"fluent-bit.yaml\",\n    \"fluent-bit.yaml\": true\n  }, \"apiVersion: v1\\nkind: ServiceAccount\\nmetadata:\\n  name: fluent-bit\\n\\n\\n---\\napiVersion: rbac.authorization.k8s.io/v1\\nkind: ClusterRole\\nmetadata:\\n  name: fluent-bit-read\\nrules:\\n- apiGroups: [\\\"\\\"]\\n  resources:\\n  - namespaces\\n  - pods\\n  verbs: [\\\"get\\\", \\\"list\\\", \\\"watch\\\"]\\n---\\napiVersion: rbac.authorization.k8s.io/v1\\nkind: ClusterRoleBinding\\nmetadata:\\n  name: fluent-bit-read\\nroleRef:\\n  apiGroup: rbac.authorization.k8s.io\\n  kind: ClusterRole\\n  name: fluent-bit-read\\nsubjects:\\n- kind: ServiceAccount\\n  name: fluent-bit\\n  namespace: default\\n\\n---\\napiVersion: v1\\nkind: ConfigMap\\nmetadata:\\n  name: fluent-bit-config\\n  namespace: default\\n  labels:\\n    k8s-app: fluent-bit\\ndata:\\n  fluent-bit.conf: |\\n    [SERVICE]\\n        Flush         1\\n        Log_Level     info\\n        Daemon        off\\n        Parsers_File  parsers.conf\\n\\n    @INCLUDE input-kubernetes.conf\\n    @INCLUDE filter-kubernetes.conf\\n    @INCLUDE output-elasticsearch.conf\\n  input-kubernetes.conf: |\\n    [INPUT]\\n        Name              tail\\n        Tag               kube.*\\n        Path              /var/log/containers/*.log\\n        Parser            docker\\n        DB                /var/log/flb_kube.db\\n        Mem_Buf_Limit     5MB\\n        Skip_Long_Lines   On\\n        Refresh_Interval  10\\n\\n  filter-kubernetes.conf: |\\n    [FILTER]\\n        Name                kubernetes\\n        Match               kube.*\\n        Kube_URL            https://kubernetes.default.svc:443\\n        Kube_CA_File        /var/run/secrets/kubernetes.io/serviceaccount/ca.crt\\n        Kube_Token_File     /var/run/secrets/kubernetes.io/serviceaccount/token\\n        Kube_Tag_Prefix     kube.var.log.containers.\\n        Merge_Log           On\\n        Merge_Log_Key       log_processed\\n        K8S-Logging.Parser  On\\n        K8S-Logging.Exclude Off\\n\\n  output-elasticsearch.conf: |\\n    [OUTPUT]\\n        Name            es\\n        Match           *\\n        Host            elasticsearch\\n        Port            9200\\n        Logstash_Format On\\n        Logstash_Prefix fluent-bit\\n        Retry_Limit     False\\n  parsers.conf: |\\n    [PARSER]\\n        Name        docker\\n        Format      json\\n        Time_Key    time\\n        Time_Format %Y-%m-%dT%H:%M:%S.%L\\n        Time_Keep   On*\\n        # Command       | Decoder   | Field | Optional Action   |\\n        # ==============|===========|=======|===================|\\n        Decode_Field_As   json        log\\n\\n---\\napiVersion: apps/v1\\nkind: DaemonSet\\nmetadata:\\n  name: fluent-bit\\n  labels:\\n    k8s-app: fluent-bit-logging\\n    version: v1\\n    kubernetes.io/cluster-service: \\\"true\\\"\\nspec:\\n  selector:\\n    matchLabels:\\n      k8s-app: fluent-bit-logging\\n  template:\\n    metadata:\\n      labels:\\n        k8s-app: fluent-bit-logging\\n        version: v1\\n        kubernetes.io/cluster-service: \\\"true\\\"\\n      annotations:\\n        prometheus.io/scrape: \\\"true\\\"\\n        prometheus.io/port: \\\"2020\\\"\\n        prometheus.io/path: /api/v1/metrics/prometheus\\n    spec:\\n      containers:\\n      - name: fluent-bit\\n        image: fluent/fluent-bit:1.5\\n        imagePullPolicy: Always\\n        ports:\\n          - containerPort: 2020\\n        env:\\n        - name: FLUENT_ELASTICSEARCH_HOST\\n          value: \\\"elasticsearch\\\"\\n        - name: FLUENT_ELASTICSEARCH_PORT\\n          value: \\\"9100\\\"\\n        volumeMounts:\\n        - name: varlog\\n          mountPath: /var/log\\n        - name: varlibdockercontainers\\n          mountPath: /var/lib/docker/containers\\n          readOnly: true\\n        - name: fluent-bit-config\\n          mountPath: /fluent-bit/etc/\\n        - name: mnt\\n          mountPath: /mnt\\n          readOnly: true\\n      terminationGracePeriodSeconds: 10\\n      volumes:\\n      - name: varlog\\n        hostPath:\\n          path: /var/log\\n      - name: varlibdockercontainers\\n        hostPath:\\n          path: /var/lib/docker/containers\\n      - name: fluent-bit-config\\n        configMap:\\n          name: fluent-bit-config\\n      - name: mnt\\n        hostPath:\\n          path: /mnt\\n      serviceAccountName: fluent-bit\\n      tolerations:\\n      - key: node-role.kubernetes.io/master\\n        operator: Exists\\n        effect: NoSchedule\\n      - operator: \\\"Exists\\\"\\n        effect: \\\"NoExecute\\\"\\n      - operator: \\\"Exists\\\"\\n        effect: \\\"NoSchedule\\\"\\n\")), mdx(\"p\", null, \"\\uCC28\\uB840\\uB300\\uB85C \\uBC30\\uD3EC\\uD558\\uBA74 \\uB2E4\\uC74C\\uACFC \\uAC19\\uC774 Pod\\uB4E4\\uC774 \\uB5A0\\uC788\\uB294 \\uAC83\\uC744 \\uBCFC \\uC218 \\uC788\\uB2E4.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-terminal\"\n  }, \"NAME                                 READY   STATUS    RESTARTS   AGE\\nelasticsearch-0                      1/1     Running   0          14h\\nfluent-bit-hpzdj                     1/1     Running   0          2m49s\\nkibana-deployment-758f66cf56-lrttf   1/1     Running   0          7m52s\\n\")), mdx(\"p\", null, \"\\uAC80\\uC0C9 \\uC870\\uAC74\\uC740 \\uB2E4\\uC74C\\uACFC \\uAC19\\uC774\\uD558\\uBA74 \\uB41C\\uB2E4\"), mdx(\"p\", null, mdx(\"span\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"960px\"\n    }\n  }, \"\\n      \", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"62.5%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAACZ0lEQVQ4y21TS2sUQRAeo//PHCJ68ewlQULAi7/Aq5dIFEECXgTBgxsTwWAwweglEj3kaXaz89jNzu5Mv5/zSfdulhXS8FE13TVffdVVncw9fIq3ewcIy/kG2lhQLsGEBBUSo5qCMA4m1WRfxTPCRERNefzeOy6wcZghufXoGZ6st7D9/Rc+bO/jz2kHlCsMa4YR4SgrGlFRjoqKCcZ+zRUqNk7y46xE6zBHMrfwGEvP1/GutY3X77dw9Lcb1TZNM7VGGxhjoLWeWmsdvPcxxngP3djoJ7cfrODNl33Ae1jXwPtmGnhNOrtu2lPO43d5hUopJMm9Zax+/ArJJSoqIZWGc24Kay28D76KypRSE5UCSol4HnwqBLS1SJL5Jbz6vBczUaFjUzjnkFJCSIm6JmCMQOtBTBYIpTKoyREoy2GMBqEnUFJGAcmd+yt4sbEDThiuhjWMdXDWwlgTs2fZMbrdDrKsQKdzjk4n+DmU6odi4xU4N5qWH0te+/QNVTlE1htEwpA1lKe1QVG0kecZ8jxFlp0iz3P0en1wkcJ7Hu/bmKtIHJAkdxfxcmsXgo1HxFgfD0JgQK93hizrThRe4PLyMirUmoXJHcc2eoZwfimWPBqU6JdVVBju6RpFMUC/X4CQc1AaLAGhDEJcwLk6NkzrdJZwES83d0GqGlm/jE2JP0VQlGWB4bAPSjNUNQMhNQgVIOQntM7gvQXjB/8rXNvcBaspyprBujCDzTQgz09iU9I0R7t9ina7jTRNYYyaiXMzhAvLWG3twEgdn1EoOQ7wpGucS3AuIASDlAMIIeJIhQdw06D/A2brxMGfh7YGAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"키바나 검색 결과\",\n    \"title\": \"키바나 검색 결과\",\n    \"src\": \"/static/7b7b70a83d9639ff0e10bb709170b9b0/7d769/kibana-result.png\",\n    \"srcSet\": [\"/static/7b7b70a83d9639ff0e10bb709170b9b0/5243c/kibana-result.png 240w\", \"/static/7b7b70a83d9639ff0e10bb709170b9b0/ab158/kibana-result.png 480w\", \"/static/7b7b70a83d9639ff0e10bb709170b9b0/7d769/kibana-result.png 960w\", \"/static/7b7b70a83d9639ff0e10bb709170b9b0/87339/kibana-result.png 1440w\", \"/static/7b7b70a83d9639ff0e10bb709170b9b0/88b03/kibana-result.png 1920w\", \"/static/7b7b70a83d9639ff0e10bb709170b9b0/c883e/kibana-result.png 3360w\"],\n    \"sizes\": \"(max-width: 960px) 100vw, 960px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n    \")));\n}\n;\nMDXContent.isMDXComponent = true;","excerpt":"최근에 맥북에 설치되어있던 Docker Desktop 을 걷어내면서 Minikube 를 설치했다.\n기왕 로컬에 클러스터를 구축한 기념으로 뭘 해볼까 생각하던 중 현재 회사에서 사용하는 EFK 를 설치해보려고 한다. 우선 elasticsearch…","timeToRead":1,"banner":null}},"pageContext":{"slug":"/미니큐브에-efk-설치하기","formatString":"DD.MM.YYYY"}},
    "staticQueryHashes": ["2744905544","3090400250","318001574"]}