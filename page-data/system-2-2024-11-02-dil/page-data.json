{"componentChunkName":"component---src-templates-post-template-tsx","path":"/system-2-2024-11-02-dil/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<h1>상세 설계</h1>\n<h2>지리 정보 테이블 구조 설계</h2>\n<ol>\n<li>Hash 와 business_ids</li>\n</ol>\n<table>\n<thead>\n<tr>\n<th>geo hash</th>\n<th>business_ids</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>32feac</td>\n<td>343, 123,</td>\n</tr>\n<tr>\n<td>f3lcad</td>\n<td>456, 789, 111</td>\n</tr>\n</tbody>\n</table>\n<ol start=\"2\">\n<li>Hash 와 business_id</li>\n</ol>\n<table>\n<thead>\n<tr>\n<th>geo hash</th>\n<th>business_id</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>32feac</td>\n<td>343</td>\n</tr>\n<tr>\n<td>32feac</td>\n<td>123</td>\n</tr>\n<tr>\n<td>f3lcad</td>\n<td>456</td>\n</tr>\n<tr>\n<td>f3lcad</td>\n<td>789</td>\n</tr>\n<tr>\n<td>f3lcad</td>\n<td>111</td>\n</tr>\n</tbody>\n</table>\n<p>전자 보다 후자가 나은 이유</p>\n<ol>\n<li>생성 및 업데이트 비용이 적음.</li>\n<li>병렬적으로 갱신이 발생한다면 락을 고려해야해서 성능 저하가 발생할 수 있음.</li>\n</ol>\n<h2>지리 정보 색인 규모 확장</h2>\n<ol>\n<li>샤딩을 진행하려면 실제 저장되는 데이터의 양을 고려해야함.</li>\n<li>지리 정보 색인은 전부 저장한다고해도 1.71G 밖에 안됨.</li>\n<li>이 경우 Read 데이터베이스를 늘리는게 좋은 판단.</li>\n</ol>\n<h2>캐시</h2>\n<p>캐시를 적용하려면 일단 캐시가 정말 필요한지 판단해야함.</p>\n<p>“데이터 베이스 크기가 상대적으로 작다.” -> 질의문은 I/O 에 좌우되지 않고 메모리 캐시와 비슷함.</p>\n<p>위의 이유를 일단 기본적으로 생각해야함. 그래도 도입해야 판단이 된다면 비용 분석에 유의.</p>\n<h3>캐시 키</h3>\n<ul>\n<li>사용자의 위도 및 경도 -> 위치 정보는 추정치 이며 같은 자리라고 해도 다른 위도, 경도를 가질 수 있기 때문에 고려대상 X</li>\n<li>사용자의 위도 및 경도를 기반으로 한 geo hash -> 사용자의 위치를 기반으로 한 캐시 키를 사용하는 것이 좋음.\n<ul>\n<li>Value 에 해당하는 작업장 정보는 자주 수정되지 않는다.</li>\n<li>검색 반경이 500m, 1km, 2km 여러가지가 존재. 모두 캐시적용 해놓아야함.</li>\n</ul>\n</li>\n</ul>\n<h3>캐시 무효화</h3>\n<ul>\n<li>사업장 정보의 변경이 발생할 때 캐시를 무효화\n<ul>\n<li>빈도수가 적기 때문에 락을 고려하지 않아도 됨.</li>\n</ul>\n</li>\n</ul>\n<h2>지역 및 가용성 구역</h2>\n<ul>\n<li>여러 지역에 나눠서 설치</li>\n<li>빠른 응답속도와 데이터보안의 이점이 존재.</li>\n</ul>\n<h2>추가질문</h2>\n<ol>\n<li>현재 영업중인 사업장, 식당 정보만 받아오기 등의 요구사항 처리는 어떻게?\n사용자의 위치에 해당하는 geo hash 를 찾아서 모든 사업장을 가져온다. 해당하는 사업장들의 개수가 적기 때문에\n여기서 필터링하여 반환.</li>\n</ol>","frontmatter":{"title":"대규모 시스템 설계 기초 2 - DIL (4)","summary":"상세설계","date":"2024.11.02.","categories":["study","DIL"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAABjElEQVR42u2U207CQBCG+8g+go9hYvTCExeoGAWDB2JQsIDFghwUiJwKrXLoAkVUvPidWUAw8cIE4pUXf3e7s/v905lmlZ5dwyKl/AMXC3REfXFAhomWgX5nPqjSIchwYCEQTGBp2YtS8REv3Qm0Do5326zaeBypJ+j9RyAFPwioJ+/hP9cl8K1vwm5U5YHhi4W3nol3h0bHJFl4pZGNBrTuiJrUt082KkX4Azo8xzcIhu9kBmo0De9pHFEtg0TyAXriHvHbrDSOxTO4UlNIp3MQTQNtNm+Pgc2nKjTamM8XcKNlkcsVpI78GtZdIRyQyfZeBKtbIbgPY9h0q3DtRxCOpOAjQzU2Mj670FEghsKHr65TaBGYg+x4QtnG9ax05lpxWdidY9y4SUY8t2mNy1MpF9GwKlCezQplEsbaTghbuypWNi7h8Wl4pfpMOu5Qc7hOfVGXf8PXupiKG8kxhR/sxkUWY/Hmrj3t4uz8V//hrNNsx/4vhz8CitE9MNKcQIY0n8owjBLsliX1CTPZynf2Ss39AAAAAElFTkSuQmCC"},"images":{"fallback":{"src":"/static/a229594a2de7c0ed63d877869e75fd38/d0859/common.png","srcSet":"/static/a229594a2de7c0ed63d877869e75fd38/f1689/common.png 270w,\n/static/a229594a2de7c0ed63d877869e75fd38/42fd3/common.png 540w,\n/static/a229594a2de7c0ed63d877869e75fd38/d0859/common.png 1080w","sizes":"(min-width: 1080px) 1080px, 100vw"},"sources":[{"srcSet":"/static/a229594a2de7c0ed63d877869e75fd38/7e223/common.webp 270w,\n/static/a229594a2de7c0ed63d877869e75fd38/5cfb6/common.webp 540w,\n/static/a229594a2de7c0ed63d877869e75fd38/941f9/common.webp 1080w","type":"image/webp","sizes":"(min-width: 1080px) 1080px, 100vw"}]},"width":1080,"height":1080}},"publicURL":"/static/a229594a2de7c0ed63d877869e75fd38/common.png"}}}}]}},"pageContext":{"slug":"/system-2-2024-11-02-dil/"}},"staticQueryHashes":[],"slicesMap":{}}